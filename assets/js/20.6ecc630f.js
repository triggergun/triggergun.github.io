(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{501:function(t,s,a){t.exports=a.p+"assets/img/image-20231003174824847.bc7dd754.png"},502:function(t,s,a){t.exports=a.p+"assets/img/image-20231003174852668.1941f012.png"},503:function(t,s,a){t.exports=a.p+"assets/img/image-20231003175427229.b4124c62.png"},504:function(t,s,a){t.exports=a.p+"assets/img/image-20231003181211739.3f63d021.png"},505:function(t,s,a){t.exports=a.p+"assets/img/image-20231003181258412.3a9ff67c.png"},506:function(t,s,a){t.exports=a.p+"assets/img/image-20231003181032740.a90a7ab3.png"},507:function(t,s,a){t.exports=a.p+"assets/img/image-20231003181015566.8a79add2.png"},508:function(t,s,a){t.exports=a.p+"assets/img/image-20231003181408398.146f8183.png"},713:function(t,s,a){"use strict";a.r(s);var n=a(14),v=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"获取临时授权和微信基本信息-4-7"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#获取临时授权和微信基本信息-4-7"}},[t._v("#")]),t._v(" 获取"),s("font",{attrs:{color:"red"}},[t._v("临时授权")]),t._v("和"),s("font",{attrs:{color:"red"}},[t._v("微信基本信息")]),t._v("[4-7]")],1),t._v(" "),s("p",[s("img",{attrs:{src:a(501),alt:"image-20231003174824847"}})]),t._v(" "),s("p",[s("img",{attrs:{src:a(502),alt:"image-20231003174852668"}})]),t._v(" "),s("p",[t._v("上个小节说到了，小程序注册新用户的时候，需要把微信临时授权字符串和微信基本信息提交给后端的Java项目，那么这节课咱们就先来获取临时授权字符串和微信基本信息，这部分内容很简单。")]),t._v(" "),s("h2",{attrs:{id:"_01-获取临时授权字符串"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_01-获取临时授权字符串"}},[t._v("#")]),t._v(" 01)获取临时授权字符串")]),t._v(" "),s("p",[t._v("在"),s("font",{attrs:{color:"red"}},[t._v("uni-app")]),t._v("框架中，包含了原生微信小程序的"),s("font",{attrs:{color:"red"}},[t._v("wx")]),t._v("对象，我们可以像写原生微信小程序代码一样，通过"),s("font",{attrs:{color:"red"}},[t._v("wx")]),t._v("对象调用各种方法。但是我更推荐大家使用"),s("font",{attrs:{color:"red"}},[t._v("uni对象")]),t._v("，因为这个对象是跨平台的，我们调用uni对象中的方法，HBuilderx在编译代码的时候，会把uni对象翻译成目标平台的对象，比如微信平台就是wx对象，支付宝平台就是"),s("font",{attrs:{color:"red"}},[t._v("my对象")]),t._v("，所以uni对象的跨平台性更好，而且调用更加简单，强烈推荐大家使用。")],1),t._v(" "),s("p",[t._v("使用uni对象可以轻松获取微信小程序的"),s("font",{attrs:{color:"red"}},[t._v("临时授权字符串")]),t._v("，这个"),s("font",{attrs:{color:"red"}},[t._v("临时授权字符串")]),t._v("是有时间限定\n的，默认有效期是"),s("font",{attrs:{color:"red"}},[t._v("5分钟")]),t._v("。如果过期，就无法换取"),s("font",{attrs:{color:"red"}},[t._v("OpenId")]),t._v("了。")],1),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("总结")]),t._v(" "),s("ul",[s("li",[t._v("使用uni对象")])])]),t._v(" "),s("p",[s("img",{attrs:{src:a(503),alt:"image-20231003175427229"}})]),t._v(" "),s("p",[s("strong",[t._v("object参数说明")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("参数名")]),t._v(" "),s("th",[t._v("类型")]),t._v(" "),s("th",[t._v("必填")]),t._v(" "),s("th",[t._v("说明")]),t._v(" "),s("th",[t._v("平台差异说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("provider【使用】")]),t._v(" "),s("td",[t._v("String")]),t._v(" "),s("td",[t._v("否")]),t._v(" "),s("td",[t._v("登录服务提供商，通过uni.getProvider获取，如果不设置则弹出登录列表选择界面")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("scopes")]),t._v(" "),s("td",[t._v("String/Array")]),t._v(" "),s("td",[t._v("见平台差异说明")]),t._v(" "),s("td",[t._v("授权类型，默认auth_base。支持"),s("br"),t._v("authbase（静默授权）/"),s("br"),t._v("auth_user（主动授权）"),s("br"),t._v("auth_zhima（芝麻信用）")]),t._v(" "),s("td",[t._v("支付宝小程序")])]),t._v(" "),s("tr",[s("td",[t._v("timeout")]),t._v(" "),s("td",[t._v("Number")]),t._v(" "),s("td",[t._v("否")]),t._v(" "),s("td",[t._v("超时时间，单位ms")]),t._v(" "),s("td",[t._v("微信小程序、百度小程序")])]),t._v(" "),s("tr",[s("td",[t._v("success")]),t._v(" "),s("td",[t._v("Function")]),t._v(" "),s("td",[t._v("否")]),t._v(" "),s("td",[t._v("接口调用成功的回调")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("fail")]),t._v(" "),s("td",[t._v("Function")]),t._v(" "),s("td",[t._v("否")]),t._v(" "),s("td",[t._v("接口调用失败的回调函数")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("complete")]),t._v(" "),s("td",[t._v("Function")]),t._v(" "),s("td",[t._v("否")]),t._v(" "),s("td",[t._v("接口调用结束的回调函数"),s("br"),t._v("（调用成功、失败都会执行）")]),t._v(" "),s("td")])])]),t._v(" "),s("p",[s("strong",[t._v("success返回参数说明")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("参数名")]),t._v(" "),s("th",[t._v("说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("authResult")]),t._v(" "),s("td",[t._v("登录服务商提供的登录信息，服务商不同返回的结果不完全相同")])]),t._v(" "),s("tr",[s("td",[t._v("code")]),t._v(" "),s("td",[t._v("小程序专有，用户登录凭证。开发者需要在开发者服务器后台，使用code换取"),s("br"),t._v("openid和sessionkey等信息")])]),t._v(" "),s("tr",[s("td",[t._v("errMsg")]),t._v(" "),s("td",[t._v("描述信息")])])])]),t._v(" "),s("p",[s("strong",[t._v("示例")])]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("uni"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("login")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("provider")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'weixin'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("success")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resp")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 领时授权字符串的")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 过期时间默认是5分钟")]),t._v("\n        console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("resp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("code"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br")])]),s("p",[s("img",{attrs:{src:a(504),alt:"image-20231003181211739"}})]),t._v(" "),s("p",[t._v("解决：")]),t._v(" "),s("p",[s("img",{attrs:{src:a(505),alt:"image-20231003181258412"}})]),t._v(" "),s("p",[s("img",{attrs:{src:a(506),alt:"image-20231003181032740"}})]),t._v(" "),s("p",[t._v("取临时授权字符串")]),t._v(" "),s("p",[s("img",{attrs:{src:a(507),alt:"image-20231003181015566"}})]),t._v(" "),s("h2",{attrs:{id:"_02-获取微信基本信息"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_02-获取微信基本信息"}},[t._v("#")]),t._v(" 02)获取微信基本信息")]),t._v(" "),s("p",[s("img",{attrs:{src:a(508),alt:"image-20231003181408398"}})]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("微信小程序端，在"),s("strong",[t._v("用户未授权")]),t._v("过的情况下调用此接口，不会出现授权弹窗，会直接进入fail回调（详见《微信小程序公告》）。")])]),t._v(" "),s("li",[s("p",[t._v("在"),s("strong",[t._v("用户已授权")]),t._v("的情况下调用此接口，可成功获取用户信息。")])])])])])}),[],!1,null,null,null);s.default=v.exports}}]);