{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[137],{1817:function(t,s,a){\"use strict\";a.r(s);var n=a(18),r=Object(n.a)({},(function(){var t=this,s=t._self._c;return s(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":t.$parent.slotKey}},[s(\"h1\",{attrs:{id:\"签名的流程\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#签名的流程\"}},[t._v(\"#\")]),t._v(\" 签名的流程\")]),t._v(\" \"),s(\"h2\",{attrs:{id:\"一百个为什么\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#一百个为什么\"}},[t._v(\"#\")]),t._v(\" 一百个为什么？\")]),t._v(\" \"),s(\"ul\",[s(\"li\",[s(\"p\",[t._v(\"什么是\"),s(\"strong\",[t._v(\"签名\")]),t._v(\"？\")])]),t._v(\" \"),s(\"li\",[s(\"p\",[t._v(\"为什么要有\"),s(\"strong\",[t._v(\"签名\")]),t._v(\"？\")])]),t._v(\" \"),s(\"li\",[s(\"p\",[s(\"strong\",[t._v(\"签名\")]),t._v(\"的流程是怎么样的呢？\")])]),t._v(\" \"),s(\"li\",[s(\"p\",[t._v(\"签名要用到哪些常见的\"),s(\"strong\",[t._v(\"算法\")]),t._v(\"？\")])])]),t._v(\" \"),s(\"h2\",{attrs:{id:\"什么是签名\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#什么是签名\"}},[t._v(\"#\")]),t._v(\" 什么是\"),s(\"strong\",[t._v(\"签名\")]),t._v(\"？\")]),t._v(\" \"),s(\"p\",[t._v(\"生活中签名的意思就是其字面的意思。如：某某偶像给粉丝进行签名、谈项目的时候在合同上签名（有法律效应的签名）。这些签名都是同一个字面意思。在计算机世界里\"),s(\"strong\",[t._v(\"签名\")]),t._v(\"也和现实世界的签名是同样的一个道理。但是唯一不同的是计算机中的签名可比现实世界的复杂。\")]),t._v(\" \"),s(\"h2\",{attrs:{id:\"为什么要有签名\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#为什么要有签名\"}},[t._v(\"#\")]),t._v(\" 为什么要有\"),s(\"strong\",[t._v(\"签名\")]),t._v(\"？\")]),t._v(\" \"),s(\"p\",[t._v(\"要说清楚为什么不是这么容易。这个是有历史迭代原因的。我简述其\"),s(\"strong\",[t._v(\"核心作用\")]),t._v(\"：\")]),t._v(\" \"),s(\"table\",[s(\"thead\",[s(\"tr\",[s(\"th\",[s(\"strong\",[t._v(\"目的\")])]),t._v(\" \"),s(\"th\",[s(\"strong\",[t._v(\"说明\")])])])]),t._v(\" \"),s(\"tbody\",[s(\"tr\",[s(\"td\",[s(\"strong\",[t._v(\"数据完整性验证\")])]),t._v(\" \"),s(\"td\",[t._v(\"检测数据是否被篡改（如中间人攻击、传输错误）。\")])]),t._v(\" \"),s(\"tr\",[s(\"td\",[s(\"strong\",[t._v(\"身份认证\")])]),t._v(\" \"),s(\"td\",[t._v(\"确认数据来源的真实性（如API请求是否来自合法客户端）。\")])]),t._v(\" \"),s(\"tr\",[s(\"td\",[s(\"strong\",[t._v(\"防抵赖（不可否认性）\")])]),t._v(\" \"),s(\"td\",[t._v(\"签名者无法事后否认自己生成过该签名（常用于法律或金融场景）。\")])])])]),t._v(\" \"),s(\"h2\",{attrs:{id:\"前端带签名的请求\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#前端带签名的请求\"}},[t._v(\"#\")]),t._v(\" 前端带签名的请求\")]),t._v(\" \"),s(\"p\",[s(\"img\",{attrs:{src:a(336),alt:\"image-20250413151858371\"}})]),t._v(\" \"),s(\"h2\",{attrs:{id:\"后端如何验证签名\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#后端如何验证签名\"}},[t._v(\"#\")]),t._v(\" \"),s(\"strong\",[t._v(\"后端如何验证签名\")])]),t._v(\" \"),s(\"div\",{staticClass:\"language-python line-numbers-mode\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-python\"}},[s(\"code\",[s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"def\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"verify_request\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"appid\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" devid\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" version\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" time01\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" client_sign\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"\\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"# 服务端用相同的规则重新计算签名\")]),t._v(\"\\n    server_sign \"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" hashlib\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"sha256\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"appid \"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\" devid \"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\" version \"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\" time01 \"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\" skey\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"encode\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"utf-8\"')]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"hexdigest\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"return\")]),t._v(\" server_sign \"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"==\")]),t._v(\" client_sign  \"),s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"# 一致则通过\")]),t._v(\"\\n\")])]),t._v(\" \"),s(\"div\",{staticClass:\"line-numbers-wrapper\"},[s(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[t._v(\"2\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[t._v(\"3\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[t._v(\"4\")]),s(\"br\")])]),s(\"p\",[t._v(\"其逻辑就是：\")]),t._v(\" \"),s(\"p\",[s(\"img\",{attrs:{src:a(337),alt:\"image-20250413161141267\"}})]),t._v(\" \"),s(\"h2\",{attrs:{id:\"为什么选择sha256\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#为什么选择sha256\"}},[t._v(\"#\")]),t._v(\" \"),s(\"strong\",[t._v(\"为什么选择SHA256？\")])]),t._v(\" \"),s(\"ul\",[s(\"li\",[s(\"strong\",[t._v(\"抗碰撞性\")]),t._v(\"：极难找到两个不同输入产生相同的哈希值。\")]),t._v(\" \"),s(\"li\",[s(\"strong\",[t._v(\"固定长度输出\")]),t._v(\"：无论输入多大，输出总是32字节，方便存储和传输。\")]),t._v(\" \"),s(\"li\",[s(\"strong\",[t._v(\"行业标准\")]),t._v(\"：被NIST、PCI DSS等权威机构推荐。\")])]),t._v(\" \"),s(\"h2\",{attrs:{id:\"安全注意事项\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#安全注意事项\"}},[t._v(\"#\")]),t._v(\" \"),s(\"strong\",[t._v(\"安全注意事项\")])]),t._v(\" \"),s(\"ol\",[s(\"li\",[s(\"strong\",[t._v(\"密钥（\"),s(\"code\",[t._v(\"skey\")]),t._v(\"）保护\")]),t._v(\"：\\n\"),s(\"ul\",[s(\"li\",[t._v(\"密钥泄露会导致签名可被伪造，必须安全存储（如使用环境变量/密钥管理服务）。\")])])]),t._v(\" \"),s(\"li\",[s(\"strong\",[t._v(\"签名包含时间戳\")]),t._v(\"：\\n\"),s(\"ul\",[s(\"li\",[t._v(\"防止重放攻击（必须代一个时间戳字符串）。\")])])]),t._v(\" \"),s(\"li\",[s(\"strong\",[t._v(\"避免参数拼接漏洞\")]),t._v(\"：\\n\"),s(\"ul\",[s(\"li\",[t._v(\"如直接拼接参数可能导致注入风险（例：\"),s(\"code\",[t._v(\"appid=123&devid=456\")]),t._v(\" 和 \"),s(\"code\",[t._v(\"appid=123&devid=456\")]),t._v(\" 可能生成相同签名）。建议使用分隔符或标准化编码（如JSON + Base64）。\")])])])]),t._v(\" \"),s(\"h2\",{attrs:{id:\"相关文档\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#相关文档\"}},[t._v(\"#\")]),t._v(\" 相关文档\")]),t._v(\" \"),s(\"p\",[s(\"a\",{attrs:{href:\"https://csrc.nist.gov/pubs/fips/180-4/upd1/final\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"FIPS 180-4, Secure Hash Standard (SHS) | CSRC\"),s(\"OutboundLink\")],1)]),t._v(\" \"),s(\"p\",[s(\"a\",{attrs:{href:\"https://docs.python.org/3/library/hashlib.html\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"hashlib — Secure hashes and message digests — Python 3.13.3 documentation\"),s(\"OutboundLink\")],1)]),t._v(\" \"),s(\"p\",[s(\"a\",{attrs:{href:\"https://cloud.google.com/endpoints/docs/openapi/when-why-api-key?hl=zh-cn\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"为何及何时使用 API 密钥  | Cloud Endpoints with OpenAPI  | Google Cloud\"),s(\"OutboundLink\")],1)]),t._v(\" \"),s(\"p\",[s(\"a\",{attrs:{href:\"https://github.com/OAI/OpenAPI-Specification/blob/main/versions/2.0.md\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"OpenAPI-Specification/versions/2.0.md at main · OAI/OpenAPI-Specification\"),s(\"OutboundLink\")],1),t._v(\"OpenApi规范。\")]),t._v(\" \"),s(\"p\",[s(\"a\",{attrs:{href:\"https://cloud.google.com/endpoints/docs/deploy-api?hl=zh-cn\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"快速入门：部署由 Cloud Endpoints 管理的 API  | Google Cloud\"),s(\"OutboundLink\")],1)]),t._v(\" \"),s(\"p\",[s(\"img\",{attrs:{src:a(338),alt:\"image-20250413155029787\"}})]),t._v(\" \"),s(\"p\",[t._v(\"有时间一定要阅读。\")])])}),[],!1,null,null,null);s.default=r.exports},336:function(t,s,a){t.exports=a.p+\"assets/img/image-20250413151858371.2752fe39.png\"},337:function(t,s,a){t.exports=a.p+\"assets/img/image-20250413161141267.84ebd137.png\"},338:function(t,s,a){t.exports=a.p+\"assets/img/image-20250413155029787.d97cfbee.png\"}}]);","extractedComments":[]}