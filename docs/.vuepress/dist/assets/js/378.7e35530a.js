(window.webpackJsonp=window.webpackJsonp||[]).push([[378],{2117:function(t,s,n){"use strict";n.r(s);var a=n(18),e=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"注解的保留策略"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注解的保留策略"}},[t._v("#")]),t._v(" 注解的保留策略")]),t._v(" "),s("p",[t._v("保留策略(Retention Policy)")]),t._v(" "),s("p",[t._v("提到策略。那当然想到的就是36计。计谋都有穷尽的时候何况策略。保留策略在java中一定是枚举变量的存在。")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("package")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lang"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("annotation")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h2",{attrs:{id:"retentionpolicy枚举源码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#retentionpolicy枚举源码"}},[t._v("#")]),t._v(" RetentionPolicy枚举源码")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * Annotation retention policy.  The constants of this enumerated type\n * describe the various policies for retaining annotations.  They are used\n * in conjunction with the {@link Retention} meta-annotation type to specify\n * how long annotations are to be retained.\n *\n * 注解保留策略。该枚举类型的常量描述了保留注解的各种策略。\n * 它们与 {@link Retention} 元注解类型结合使用，以指定注解应被保留多长时间。\n *\n * @author  Joshua Bloch\n * @since 1.5\n */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("enum")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RetentionPolicy")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * Annotations are to be discarded by the compiler.\n     * 注解将被编译器丢弃。\n     */")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SOURCE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * Annotations are to be recorded in the class file by the compiler\n     * but need not be retained by the VM at run time.  This is the default\n     * behavior.\n     * 注解将由编译器记录在类文件中，但在运行时不需要被虚拟机保留。这是默认行为。\n     */")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("CLASS")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * Annotations are to be recorded in the class file by the compiler and\n     * retained by the VM at run time, so they may be read reflectively.\n     * 注解将由编译器记录在类文件中，并在运行时由虚拟机保留，因此可以通过反射读取。\n     *\n     * @see java.lang.reflect.AnnotatedElement\n     */")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("RUNTIME")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br"),s("span",{staticClass:"line-number"},[t._v("34")]),s("br"),s("span",{staticClass:"line-number"},[t._v("35")]),s("br"),s("span",{staticClass:"line-number"},[t._v("36")]),s("br")])]),s("h2",{attrs:{id:"retentionpolicy枚举值总结表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#retentionpolicy枚举值总结表"}},[t._v("#")]),t._v(" RetentionPolicy枚举值总结表")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("策略值")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("生命周期")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("编译后是否保留")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("运行时是否可用")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("默认行为")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("应用在哪些地方？")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("解决了什么问题？")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("作用是什么？")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("具体框架/注解示例")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("SOURCE")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("源码级别")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("❌ 否")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("❌ 否")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("-")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("1. 编译器")]),t._v(" "),s("strong",[t._v("2. IDE工具")]),t._v(" "),s("strong",[t._v("3. 代码生成器")]),t._v(" "),s("strong",[t._v("4. 静态分析工具")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("1. "),s("strong",[t._v("防止编码错误")]),t._v(" 2. "),s("strong",[t._v("减少样板代码")]),t._v(" 3. "),s("strong",[t._v("统一代码规范")]),t._v(" 4. "),s("strong",[t._v("自动化代码生成")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("1. "),s("strong",[t._v("语法检查")]),t._v("：验证代码正确性 2. "),s("strong",[t._v("警告管理")]),t._v("：控制编译器警告 3. "),s("strong",[t._v("代码生成")]),t._v("：自动创建重复代码 4. "),s("strong",[t._v("静态分析")]),t._v("：发现潜在问题")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("1. "),s("strong",[t._v("Java内置")]),t._v("："),s("code",[t._v("@Override")]),t._v("（方法重写检查） 2. "),s("strong",[t._v("Java内置")]),t._v("："),s("code",[t._v("@SuppressWarnings")]),t._v("（抑制警告） 3. "),s("strong",[t._v("Lombok")]),t._v("："),s("code",[t._v("@Getter")]),t._v("/"),s("code",[t._v("@Setter")]),t._v("（自动生成getter/setter） 4. "),s("strong",[t._v("Android")]),t._v("："),s("code",[t._v("@NonNull")]),t._v("（空值检查） 5. "),s("strong",[t._v("FindBugs")]),t._v("："),s("code",[t._v("@Nullable")]),t._v("（空指针检查）")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("CLASS")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("类文件级别")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("✅ 是")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("❌ 否")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("默认值")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("1. 字节码操作框架")]),t._v(" "),s("strong",[t._v("2. AOP框架")]),t._v(" "),s("strong",[t._v("3. 类加载器")]),t._v(" "),s("strong",[t._v("4. 编译时处理器")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("1. "),s("strong",[t._v("字节码增强")]),t._v(" 2. "),s("strong",[t._v("性能优化")]),t._v(" 3. "),s("strong",[t._v("横切关注点分离")]),t._v(" 4. "),s("strong",[t._v("编译时代码修改")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("1. "),s("strong",[t._v("字节码处理")]),t._v("：在编译后修改类文件 2. "),s("strong",[t._v("AOP实现")]),t._v("：方法拦截和增强 3. "),s("strong",[t._v("代理生成")]),t._v("：创建动态代理类 4. "),s("strong",[t._v("性能监控")]),t._v("：注入监控代码")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("1. "),s("strong",[t._v("AspectJ")]),t._v("："),s("code",[t._v("@Aspect")]),t._v("（切面定义） 2. "),s("strong",[t._v("ASM框架")]),t._v("：字节码操作注解 3. "),s("strong",[t._v("ByteBuddy")]),t._v("：动态类生成注解 4. "),s("strong",[t._v("Spring AOP")]),t._v("：部分内部注解 5. "),s("strong",[t._v("JaCoCo")]),t._v("：代码覆盖率分析注解")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("RUNTIME")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("运行时级别")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("✅ 是")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("✅ 是")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("-")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("1. 依赖注入框架")]),t._v(" "),s("strong",[t._v("2. ORM框架")]),t._v(" "),s("strong",[t._v("3. Web框架")]),t._v(" "),s("strong",[t._v("4. 序列化框架")]),t._v(" "),s("strong",[t._v("5. 配置框架")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("1. "),s("strong",[t._v("依赖管理")]),t._v(" 2. "),s("strong",[t._v("对象关系映射")]),t._v(" 3. "),s("strong",[t._v("请求路由")]),t._v(" 4. "),s("strong",[t._v("数据转换")]),t._v(" 5. "),s("strong",[t._v("运行时配置")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("1. "),s("strong",[t._v("IoC容器")]),t._v("：管理对象生命周期和依赖 2. "),s("strong",[t._v("数据映射")]),t._v("：数据库表与对象映射 3. "),s("strong",[t._v("请求处理")]),t._v("：HTTP请求与方法映射 4. "),s("strong",[t._v("序列化")]),t._v("：对象与JSON/XML转换 5. "),s("strong",[t._v("配置驱动")]),t._v("：基于注解的配置管理")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("1. "),s("strong",[t._v("Spring")]),t._v("："),s("code",[t._v("@Component")]),t._v("（组件扫描） 2. "),s("strong",[t._v("Spring")]),t._v("："),s("code",[t._v("@Autowired")]),t._v("（依赖注入） 3. "),s("strong",[t._v("JPA/Hibernate")]),t._v("："),s("code",[t._v("@Entity")]),t._v("（实体映射） 4. "),s("strong",[t._v("Spring MVC")]),t._v("："),s("code",[t._v("@RequestMapping")]),t._v("（请求映射） 5. "),s("strong",[t._v("Jackson")]),t._v("："),s("code",[t._v("@JsonProperty")]),t._v("（JSON属性映射） 6. "),s("strong",[t._v("Spring Boot")]),t._v("："),s("code",[t._v("@Configuration")]),t._v("（配置类） 7. "),s("strong",[t._v("JUnit")]),t._v("："),s("code",[t._v("@Test")]),t._v("（测试方法） 8. "),s("strong",[t._v("Swagger")]),t._v("："),s("code",[t._v("@ApiOperation")]),t._v("（API文档）")])])])]),t._v(" "),s("h2",{attrs:{id:"详细说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#详细说明"}},[t._v("#")]),t._v(" 详细说明")]),t._v(" "),s("h3",{attrs:{id:"_1-source-源码级"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-source-源码级"}},[t._v("#")]),t._v(" 1. "),s("strong",[t._v("SOURCE（源码级）")])]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("特点")]),t._v("：仅在源代码中存在，编译后完全消失")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("使用方式")]),t._v("：只能通过注解处理器（Annotation Processor）在编译时访问")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("典型示例")]),t._v("：")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 编译时检查方法是否真的重写了父类方法")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@SuppressWarnings")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"unchecked"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 告诉编译器忽略特定警告")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Deprecated")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 标记已过时的方法或类")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])])])]),t._v(" "),s("h3",{attrs:{id:"_2-class-类文件级"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-class-类文件级"}},[t._v("#")]),t._v(" 2. "),s("strong",[t._v("CLASS（类文件级）")])]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("特点")]),t._v("：保留在 "),s("code",[t._v(".class")]),t._v(" 字节码文件中，但不加载到 JVM 内存")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("使用方式")]),t._v("：通过字节码操作框架（如 ASM、ByteBuddy）在类加载前处理")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("典型示例")]),t._v("：")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 很多框架的内部注解使用此策略")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 例如某些 AOP 框架在编译时织入代码")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])])])]),t._v(" "),s("h3",{attrs:{id:"_3-runtime-运行时级"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-runtime-运行时级"}},[t._v("#")]),t._v(" 3. "),s("strong",[t._v("RUNTIME（运行时级）")])]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("特点")]),t._v("：完全保留，可通过反射 API 在运行时获取")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("使用方式")]),t._v("：使用 "),s("code",[t._v("Class.getAnnotations()")]),t._v("、"),s("code",[t._v("Method.getAnnotation()")]),t._v(" 等方法")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("典型示例")]),t._v("：")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@RestController")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Spring MVC 控制器")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@RequestMapping")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/api"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyController")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@GetMapping")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/users"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ResponseBody")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("User")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUsers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br")])])])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"保留策略选择建议"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#保留策略选择建议"}},[t._v("#")]),t._v(" 保留策略选择建议")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("场景")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("推荐策略")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("原因")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("仅编译时检查")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("SOURCE")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("不增加运行时开销，保持类文件简洁")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("框架需要处理字节码")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("CLASS")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("框架可在类加载时修改字节码，但运行时不需要")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("运行时依赖注解")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("RUNTIME")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("框架需要通过反射读取注解配置")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("不确定未来用途")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("RUNTIME")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("保持灵活性，可随时通过反射访问")])])])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"代码示例对比"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#代码示例对比"}},[t._v("#")]),t._v(" 代码示例对比")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// SOURCE 策略 - 编译后消失")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// RetentionPolicy.SOURCE")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"example"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// CLASS 策略 - 保留在类文件中但不加载到 JVM")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@SomeAspectAnnotation")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// RetentionPolicy.CLASS - AspectJ 等使用")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("someMethod")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// RUNTIME 策略 - 可通过反射获取")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Component")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// RetentionPolicy.RUNTIME - Spring 框架")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyService")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Autowired")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// RetentionPolicy.RUNTIME")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyRepository")]),t._v(" repository"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br")])]),s("h2",{attrs:{id:"内存与性能考虑"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#内存与性能考虑"}},[t._v("#")]),t._v(" 内存与性能考虑")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("SOURCE")]),t._v("：无运行时开销")]),t._v(" "),s("li",[s("strong",[t._v("CLASS")]),t._v("：轻微磁盘空间开销（类文件稍大），无内存开销")]),t._v(" "),s("li",[s("strong",[t._v("RUNTIME")]),t._v("：有内存开销（注解对象常驻内存），反射调用有性能开销")])]),t._v(" "),s("p",[t._v("选择适当的保留策略有助于平衡功能需求与系统性能。")])])}),[],!1,null,null,null);s.default=e.exports}}]);